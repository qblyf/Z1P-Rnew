# 版本管理使用次数统计功能

## 功能说明

在基础数据管理的版本管理（以及配置管理、颜色管理）中，现在会显示每个规格值在系统中的使用次数。

## 实现细节

### 1. 数据统计
- 系统会自动统计每个版本/配置/颜色在所有SKU中的使用次数
- 统计范围：所有状态为"在用"的SPU及其关联的SKU
- 统计逻辑：
  - 版本管理：统计SKU中`combo`字段的使用次数
  - 配置管理：统计SKU中`spec`字段的使用次数
  - 颜色管理：统计SKU中`color`字段的使用次数

### 2. 显示位置

#### 卡片显示
每个规格卡片底部会显示：
- 排序权重
- **使用次数**（新增）
  - 已使用的规格：绿色加粗显示，如"使用 5 次"
  - 未使用的规格：灰色显示，如"使用 0 次"

#### 统计面板
页面顶部新增4个统计卡片：
1. **全部版本**：所有版本的总数
2. **已使用**：至少被使用1次的版本数量
3. **未使用**：从未被使用的版本数量
4. **总使用次数**：所有版本的累计使用次数

### 3. 性能优化
- 使用次数在页面加载时一次性计算
- 数据缓存在组件状态中，避免重复查询
- 支持大量数据（最多10000个SPU）

## 使用场景

1. **数据清理**：快速识别未使用的版本，便于清理冗余数据
2. **热门分析**：了解哪些版本最常用，优化排序和推荐
3. **数据审计**：检查版本配置的完整性和使用情况

## 技术实现

### 关键代码位置
- 文件：`Z1P-Rnew/app/basedata-manage/page.tsx`
- 函数：`loadUsageCounts()` - 统计使用次数
- 组件：`DraggableSpecCard` - 显示使用次数
- 组件：`SpecManage` - 管理规格和统计数据

### 数据流
1. 页面加载时调用`loadSpecs()`
2. `loadSpecs()`内部调用`loadUsageCounts()`
3. `loadUsageCounts()`查询所有SPU和SKU数据
4. 遍历SKU，统计每个规格值的出现次数
5. 将统计结果存储在`usageCounts` Map中
6. 渲染时将使用次数传递给卡片组件显示

## 注意事项

1. 统计数据基于当前数据库状态，不是实时更新
2. 需要刷新页面才能看到最新的使用次数
3. 仅统计"在用"状态的SPU，已删除或停用的不计入
4. 大数据量时首次加载可能需要几秒钟
