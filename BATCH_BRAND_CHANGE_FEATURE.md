# 批量修改 SPU 品牌功能

## 功能概述

在 SPU 命名规范检查页面中新增了批量修改 SPU 品牌的功能，允许用户一次性将某个品牌下的所有在用 SPU 修改为另一个品牌。

## 功能位置

- 页面路径：`/spu-name-check`
- 按钮位置：页面标题栏右侧的"批量修改品牌"按钮

## 使用步骤

1. **进入页面**：访问 SPU 命名规范检查页面
2. **执行检查**：点击"开始检查"按钮，加载 SPU 数据（这一步会加载所有品牌列表）
3. **打开功能**：点击页面右上角的"批量修改品牌"按钮
4. **选择原品牌**：在弹出的对话框中选择要修改的原品牌
   - 选择后会自动显示该品牌下有多少个在用 SPU
5. **选择新品牌**：选择要修改为的新品牌
6. **确认修改**：点击"开始修改"按钮
7. **二次确认**：在确认对话框中再次确认操作
8. **等待完成**：系统会批量修改所有 SPU，完成后显示成功/失败数量

## 功能特点

### 自动更新名称
- 修改品牌时，会自动更新 SPU 名称中的品牌部分
- 例如：`Apple iPhone 14` → `苹果 iPhone 14`

### 安全机制
- 只修改"在用"状态的 SPU
- 二次确认机制，防止误操作
- 显示受影响的 SPU 数量
- 详细的成功/失败统计

### 批量处理
- 支持一次性修改多个 SPU
- 自动处理每个 SPU 的修改
- 失败时不影响其他 SPU 的修改

## 注意事项

⚠️ **重要提示**：
1. 此操作不可撤销，请谨慎操作
2. 只会修改"在用"状态的 SPU
3. SPU 名称会自动更新，将原品牌名替换为新品牌名
4. 修改完成后需要重新点击"开始检查"按钮刷新数据

## 技术实现

### 核心 API
- `getSPUListNew`：获取 SPU 列表
- `editSPUInfo`：修改单个 SPU 信息

### 修改逻辑
```typescript
// 1. 获取所有指定品牌的在用 SPU
const spuList = await getSPUListNew({
  brands: [oldBrand],
  states: [SPUState.在用],
  limit: 10000,
});

// 2. 批量修改每个 SPU
for (const spu of spuList) {
  // 替换名称中的品牌
  const newName = spu.name.replace(/^原品牌\s*/, '新品牌 ');
  
  // 修改 SPU
  await editSPUInfo(spu.id, {
    brand: newBrand,
    name: newName,
  });
}
```

## 使用场景

1. **品牌名称规范化**：统一品牌名称的大小写或格式
2. **品牌合并**：将多个品牌合并为一个
3. **品牌更名**：品牌官方更名后批量更新
4. **数据清理**：修正错误的品牌信息

## 界面截图说明

### 批量修改对话框
- 原品牌选择器：下拉选择要修改的品牌
- 受影响数量提示：显示该品牌下有多少个 SPU
- 新品牌选择器：下拉选择新的品牌
- 注意事项提示：警告用户操作不可撤销

### 确认对话框
- 显示具体的修改数量和品牌信息
- 红色确认按钮，强调操作的重要性

## 更新日志

### 2024-01-21
- ✨ 新增批量修改 SPU 品牌功能
- ✨ 自动更新 SPU 名称中的品牌部分
- ✨ 添加二次确认机制
- ✨ 显示受影响的 SPU 数量
- ✨ 详细的成功/失败统计
