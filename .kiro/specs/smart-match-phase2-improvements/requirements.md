# 智能匹配系统第二阶段改进 - 需求文档

## 概述

本规范定义了智能匹配系统的第二阶段改进需求。第一阶段已将准确率从 67% 提升到 73.5%，第二阶段目标是进一步提升到 83.5%（+10%），通过五个关键改进领域实现。

## 术语表

| 术语 | 定义 |
|------|------|
| **特殊产品类型** | 手表、平板、笔记本等非手机产品 |
| **版本/变体** | 活力版、优享版、尊享版等产品版本标记 |
| **颜色变体** | 同一种颜色的不同写法（如"雾凇蓝"和"雾松蓝"） |
| **产品名称格式** | 输入中的产品名称与系统中 SPU 名称的格式差异 |
| **SPU** | 产品型号级别，代表产品系列 |
| **SKU** | 库存单位，代表具体的产品规格组合（颜色、存储等） |

## 需求

### 需求 1: 特殊产品类型识别 (PHASE2-1)

**优先级**: 高 | **预期改进**: 30-40 条记录 | **准确率提升**: +4%

**用户故事**: 作为系统用户，我想要系统能够正确识别和匹配手表、平板、笔记本等特殊产品类型，以便获得准确的匹配结果。

**接受标准**:

1. WHEN 输入包含手表产品（如"华为WatchGT6 41mm"）时，THEN 系统应正确提取型号（watch gt 6）
2. WHEN 输入包含平板产品（如"华为MatePad Pro 11寸"）时，THEN 系统应正确提取型号（mate pad pro）
3. WHEN 输入包含笔记本产品（如"华为MateBook14"）时，THEN 系统应正确提取型号（mate book 14）
4. WHEN 输入包含尺寸信息（如"42mm"、"11寸"）时，THEN 系统应正确处理尺寸信息而不影响型号提取
5. WHEN 输入包含屏幕参数（如"柔光版"、"标准版"）时，THEN 系统应正确识别这些参数

---

### 需求 2: 版本/变体处理改进 (PHASE2-2)

**优先级**: 中 | **预期改进**: 10-15 条记录 | **准确率提升**: +1.5%

**用户故事**: 作为系统用户，我想要系统能够正确处理产品的版本和变体信息（如活力版、优享版等），以便准确匹配对应的 SKU。

**接受标准**:

1. WHEN 输入包含版本标记（如"活力版"、"优享版"）时，THEN 系统应提取版本信息
2. WHEN 匹配 SKU 时，THEN 系统应考虑版本信息作为匹配条件
3. WHEN 输入版本与 SKU 版本不匹配时，THEN 系统应优先选择版本匹配的 SKU
4. WHEN 输入不包含版本信息时，THEN 系统应优先选择标准版本的 SKU
5. WHEN SKU 列表中版本标记不一致时，THEN 系统应能够处理多种版本标记格式

---

### 需求 3: 特殊颜色名称识别 (PHASE2-3)

**优先级**: 中 | **预期改进**: 8-12 条记录 | **准确率提升**: +1%

**用户故事**: 作为系统用户，我想要系统能够识别更多特殊的颜色名称（如"玉石绿"、"玛瑙粉"等），以便准确匹配产品颜色。

**接受标准**:

1. WHEN 输入包含复合颜色名称（如"玉石绿"、"玛瑙粉"）时，THEN 系统应正确识别这些颜色
2. WHEN 输入包含带修饰词的颜色（如"夏夜黑"、"辰夜黑"）时，THEN 系统应正确识别这些颜色
3. WHEN 输入颜色与 SKU 颜色不完全匹配时，THEN 系统应尝试颜色变体匹配
4. WHEN 输入颜色与 SKU 颜色都包含相同的基础颜色时，THEN 系统应进行基础颜色匹配
5. WHEN 动态颜色列表中包含新颜色时，THEN 系统应优先使用动态列表中的颜色

---

### 需求 4: 产品名称格式统一 (PHASE2-4)

**优先级**: 高 | **预期改进**: 20-30 条记录 | **准确率提升**: +2.5%

**用户故事**: 作为系统用户，我想要系统能够处理输入中的产品名称格式差异（如空格、大小写等），以便与系统中的 SPU 名称正确匹配。

**接受标准**:

1. WHEN 输入包含空格变体（如"Reno15"vs"Reno 15"）时，THEN 系统应正确标准化为统一格式
2. WHEN 输入包含大小写混合时，THEN 系统应正确处理大小写差异
3. WHEN 输入包含多余空格时，THEN 系统应清理多余空格
4. WHEN 输入包含特殊字符（如"（"、"）"）时，THEN 系统应正确处理这些字符
5. WHEN 输入包含型号代码（如"WA2456C"）时，THEN 系统应正确提取型号而不被代码干扰

---

### 需求 5: 多品牌混淆处理 (PHASE2-5)

**优先级**: 中 | **预期改进**: 10-15 条记录 | **准确率提升**: +1.5%

**用户故事**: 作为系统用户，我想要系统能够正确处理包含多个品牌名称的输入，以便准确识别主品牌。

**接受标准**:

1. WHEN 输入中出现多个品牌名称时，THEN 系统应正确识别主品牌
2. WHEN 输入中包含配件品牌和产品品牌时，THEN 系统应区分两者并选择产品品牌
3. WHEN 输入中包含子品牌时，THEN 系统应正确映射到主品牌
4. WHEN 品牌识别有歧义时，THEN 系统应使用型号信息进行反向确认
5. WHEN 输入中品牌信息不明确时，THEN 系统应优先使用型号进行匹配

---

## 总体目标

### 准确率改进

| 指标 | 数值 |
|------|------|
| 当前状态（第一阶段后） | 73.5% (575/783 条) |
| 第二阶段目标 | 83.5% (653/783 条) |
| 总改进 | +10% (+78 条记录) |

### 需求优先级与影响

| 需求 | 优先级 | 影响记录 | 准确率提升 |
|------|--------|--------|----------|
| 特殊产品类型识别 (PHASE2-1) | 高 | 30-40 | +4% |
| 产品名称格式统一 (PHASE2-4) | 高 | 20-30 | +2.5% |
| 版本/变体处理改进 (PHASE2-2) | 中 | 10-15 | +1.5% |
| 多品牌混淆处理 (PHASE2-5) | 中 | 10-15 | +1.5% |
| 特殊颜色名称识别 (PHASE2-3) | 中 | 8-12 | +1% |
| **总计** | - | **78-112** | **+10%** |

---

## 实施计划

### 推荐实施顺序

按优先级和依赖关系，建议按以下顺序实施：

1. **PHASE2-1: 特殊产品类型识别** (4-6 小时)
   - 为手表、平板、笔记本设计专门的型号提取规则
   - 处理尺寸、屏幕参数等特殊信息

2. **PHASE2-4: 产品名称格式统一** (2-3 小时)
   - 改进输入预处理逻辑
   - 处理空格变体、大小写、特殊字符

3. **PHASE2-2: 版本/变体处理改进** (2-3 小时)
   - 添加版本提取方法
   - 改进 SKU 匹配逻辑

4. **PHASE2-3: 特殊颜色名称识别** (1-2 小时)
   - 扩展颜色识别库
   - 改进颜色匹配算法

5. **PHASE2-5: 多品牌混淆处理** (1-2 小时)
   - 改进品牌识别优先级
   - 添加反向确认逻辑

**总工作量**: 10-16 小时

---

## 依赖关系与约束

- 本规范依赖于第一阶段的修复已完成
- 各需求之间相对独立，可以并行实施
- 建议按优先级顺序实施以最大化早期收益

---

## 成功标准

✅ 所有 5 个需求的接受标准都满足  
✅ 准确率从 73.5% 提升到 83.5%  
✅ 所有修改都有相应的测试覆盖  
✅ 代码无错误，通过 TypeScript 类型检查  
✅ 所有修改都已提交到 Git

