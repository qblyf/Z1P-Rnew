# SKU 管理器布局优化 - 设计文档

## 概述

SKU Manager 组件需要实现固定/可滚动分离的布局模式，以解决以下问题：
1. 当 SKU 列表很长时，操作按钮被隐藏在视口下方
2. 用户需要滚动到底部才能看到按钮
3. 布局不够灵活，无法适应不同的内容量

## 架构设计

SKU Manager 组件采用三区域布局：

```
┌─────────────────────────────────────┐
│ SPU 信息 & 过滤控件 (固定)          │  ← flexShrink: 0
├─────────────────────────────────────┤
│                                     │
│  SKU 表格 (可滚动)                  │  ← flex: 1, overflowY: auto
│  - 表头 (sticky)                    │
│  - 行数据                           │
│                                     │
├─────────────────────────────────────┤
│ 操作按钮 (固定)                     │  ← flexShrink: 0
└─────────────────────────────────────┘
```

## 组件结构

### SKUManager 组件布局

**问题分析**:
- 外层容器使用 `display: flex` 和 `flexDirection: column`
- 中间可滚动区域有 `flex: 1` 和 `overflowY: auto`
- 表格页脚在可滚动区域内，导致滚动时被隐藏

**解决方案**:
- 将表格和页脚分离到不同的区域
- 表格保留在可滚动区域
- 页脚移到可滚动区域外的固定底部区域
- 确保可滚动区域有适当的高度约束

### 布局实现

```typescript
<div style={{ display: 'flex', flexDirection: 'column', height: '100%' }}>
  {/* 区域 1: 固定顶部 - SPU 信息 */}
  <div style={{ flexShrink: 0 }}>
    SPU ID 和名称信息
  </div>

  {/* 区域 2: 可滚动中部 - 表单和表格 */}
  <div style={{ flex: 1, overflowY: 'auto', minHeight: 0 }}>
    <Form>
      {/* 过滤控件 */}
    </Form>
    <Table>
      {/* 仅表格内容，无页脚 */}
    </Table>
  </div>

  {/* 区域 3: 固定底部 - 操作按钮 */}
  <div style={{ flexShrink: 0, borderTop: '1px solid #f0f0f0', padding: '16px' }}>
    <Button>+ 新增</Button>
    <Button>确认修改</Button>
  </div>
</div>
```

### 关键 CSS 属性

| 属性 | 值 | 说明 |
|------|-----|------|
| `display` | `flex` | 启用 flexbox 布局 |
| `flexDirection` | `column` | 垂直排列 |
| `height` | `100%` | 占满容器高度 |
| `flexShrink: 0` | 顶部/底部 | 防止收缩 |
| `flex: 1` | 中部 | 占用剩余空间 |
| `minHeight: 0` | 中部 | 关键！允许 flex 容器正确计算高度 |
| `overflowY: auto` | 中部 | 启用垂直滚动 |

## 正确性属性

### 属性 1: 操作按钮始终可见

**对于任何** SKU 列表大小（0 到 1000+ 项），操作按钮 SHALL 始终在视口内可见，不会因表格滚动而被隐藏。

**验证**: 需求 1, 3

### 属性 2: 表格可滚动性

**对于任何** 超过可用垂直空间的 SKU 列表，表格区域 SHALL 可滚动，而头部和底部保持固定。

**验证**: 需求 2

### 属性 3: 布局稳定性

**对于任何** 视口高度和 SKU 列表大小，组件布局 SHALL 保持一致的间距和对齐，无溢出或布局抖动。

**验证**: 需求 4, 5

## 测试策略

### 单元测试

- 测试组件在不同 SKU 列表大小下的渲染（0, 1, 10, 100, 1000 项）
- 验证操作按钮在 DOM 中存在
- 验证可滚动区域有正确的 CSS 属性
- 测试组件在不同屏幕尺寸上的布局

### 属性测试

- **属性 1 测试**: 对于任何生成的 SKU 列表，验证操作按钮保持在视口内
- **属性 2 测试**: 对于超过可用空间的 SKU 列表，验证表格可滚动性
- **属性 3 测试**: 对于任何视口高度，验证布局稳定性和无溢出

### 集成测试

- 测试表格滚动时"新增"按钮的点击功能
- 测试表格滚动时"确认修改"按钮的点击功能
- 测试表格滚动时表单控件的功能

